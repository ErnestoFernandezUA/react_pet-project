(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{51:function(t,e,n){},53:function(t,e,n){},54:function(t,e,n){},57:function(t,e,n){},58:function(t,e,n){},59:function(t,e,n){},60:function(t,e,n){},61:function(t,e,n){},62:function(t,e,n){},63:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){"use strict";n.r(e);var o=n(2),r=n(29),a=n.n(r),i=n(30),c=n(18),s=c.b,u=c.c,l=n(10),d=n(6),b=n(11),f=n(9),j=n(68),h="https://picsum.photos",p=j.a.create({baseURL:h}),O=function(t){return Object(b.a)(Object(d.a)().mark((function e(){var n;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get(t);case 2:return n=e.sent,console.log("fetch to",h+t),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))()},m=function(t,e){return O("v2/list?page=".concat(t,"&limit=").concat(e))},g=Object(f.b)("server/fetchPhotos",function(){var t=Object(b.a)(Object(d.a)().mark((function t(e){var n,o,r,a;return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.page,o=e.limit,r=void 0===o?100:o,t.next=3,m(n,r);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),x=Object(f.c)({name:"server",initialState:{storage:[],statusLoading:"idle",error:null,nextLoadingPhotoIndex:0,randomDelayLoading:!1},reducers:{add:function(t,e){var n;(n=t.storage).push.apply(n,Object(l.a)(e.payload))},sortById:function(t){t.storage.sort((function(t,e){return Number(t.id)-Number(e.id)}))},setStatusLoading:function(t,e){t.statusLoading=e.payload},setError:function(t,e){t.error=e.payload,t.statusLoading="failed"},loadNextPhoto:function(t){t.nextLoadingPhotoIndex+=1},setRandomDelay:function(t,e){t.randomDelayLoading=e.payload}},extraReducers:function(t){t.addCase(g.pending,(function(t){t.statusLoading="loading"})).addCase(g.fulfilled,(function(t,e){var n;e.payload.sort((function(t,e){return Number(t.id)-Number(e.id)})),(n=t.storage).push.apply(n,Object(l.a)(e.payload)),t.statusLoading="idle"})).addCase(g.rejected,(function(t){t.statusLoading="failed"}))}}),y=x.reducer,v=x.actions,_=(v.add,v.sortById,v.setStatusLoading,v.setError),N=v.loadNextPhoto,C=v.setRandomDelay,k=function(t){return t.server.statusLoading},w=function(t){return t.server.randomDelayLoading},I=function(t){try{t(g({page:1,limit:100}))}catch(e){t(_(e))}},L=(n(51),n(1)),S=function(){return Object(L.jsx)("div",{className:"Loader",children:Object(L.jsx)("div",{className:"Loader__content"})})},F=n(8),D=n(5),P=n.n(D),H={isOptionsVisible:!1,isDeletedVisible:!1,width:350,height:250,"border-radius":5},q=Object(f.c)({name:"options",initialState:H,reducers:{setVisible:function(t,e){t.isOptionsVisible=e.payload},setWidth:function(t,e){e.payload>0&&e.payload<=350&&(t.width=e.payload)},setHeight:function(t,e){e.payload>0&&e.payload<=350&&(t.height=e.payload)},setBorderRadius:function(t,e){e.payload>=0&&e.payload<=50&&(t["border-radius"]=e.payload)},resetOptions:function(t){H},changeVisibleDeleted:function(t,e){t.isDeletedVisible=e.payload}}}),R=q.reducer,E=q.actions,M=E.setVisible,V=E.setWidth,B=E.setHeight,A=E.setBorderRadius,T=(E.resetOptions,E.changeVisibleDeleted),W=function(t){return t.options.isOptionsVisible},z=function(t){return t.options.height},J=function(t){return t.options.width},K=function(t){return t.options["border-radius"]},U=function(t){return t.options.isDeletedVisible},G=(n(53),function(t){var e=t.content,n=t.onCross,o=e.author,r=e.download_url,a=e.status,i={width:u(J),minWidth:"200px",height:u(z),borderRadius:u(K),backgroundImage:"url(".concat(r,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"};return Object(L.jsxs)("div",{className:P()("Card",{CardLoader:"loading"===a}),style:i,children:["loading"===a&&Object(L.jsx)("div",{className:"CardLoader__content"}),"idle"===a&&Object(L.jsxs)("div",{className:"Card--visible",children:[Object(L.jsx)("div",{className:"Card__title",children:o}),Object(L.jsx)("div",{className:"Card__button-cross",onClick:function(){return n()},onKeyDown:function(){n()},role:"button",tabIndex:0})]})]})}),Q=n(13);function X(t,e){return t.findIndex((function(t){return t.requestId===e}))>=0}function Y(t,e,n){return t.map((function(t){return t.requestId!==e?t:Object(Q.a)(Object(Q.a)(Object(Q.a)({},t),n),{},{status:"idle",requestId:null})}))}var Z={list:[],deleted:[],onFill:!1,onFillLoadingStatus:"idle",loaded:[]},$=Object(f.b)("photo/fetchPhoto",function(){var t=Object(b.a)(Object(d.a)().mark((function t(e,n){var o,r,a,i,c,s,u,l;return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.getState,r=n.dispatch,a=n.requestId,i=o(),c=i.server,s=c.storage[c.nextLoadingPhotoIndex],r(N()),u=3e3,i.server.randomDelayLoading&&(u=1e3+3e3*Math.random()),t.next=9,new Promise((function(t){setTimeout((function(){return t(Object(Q.a)(Object(Q.a)({},s),{},{requestId:a,status:"loading"}))}),u)}));case 9:return l=t.sent,t.abrupt("return",l);case 11:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),tt=Object(f.c)({name:"photo",initialState:Z,reducers:{changePhotoByRequestId:function(t,e){t.list.forEach((function(t){return t.requestId!==e.payload.requestId?t:Object(Q.a)(Object(Q.a)(Object(Q.a)({},t),e.payload.photo),{},{status:e.payload.status})}))},deletePhoto:function(t,e){if(e.payload||"0"===e.payload){var n,o=t.list.findIndex((function(t){return t.id===e.payload}));if(o>=0)(n=t.deleted).push.apply(n,Object(l.a)(t.list.splice(o,1)))}else t.list.length&&(t.deleted.push(t.list[t.list.length-1]),t.list.length--)},restorePhoto:function(t,e){if(e.payload||"0"===e.payload){var n,o=t.deleted.findIndex((function(t){return t.id===e.payload}));if(console.log(o),o>=0)(n=t.list).push.apply(n,Object(l.a)(t.deleted.splice(o,1)))}},restoreAll:function(t){var e;(e=t.list).push.apply(e,Object(l.a)(t.deleted)),t.deleted.length=0},setOnFill:function(t,e){t.onFill=e.payload},clear:function(t){var e;(e=t.deleted).push.apply(e,Object(l.a)(t.list.splice(1)))},reset:function(){return Z}},extraReducers:function(t){t.addCase($.pending,(function(t,e){t.onFill&&(t.onFillLoadingStatus="loading");var n={id:null,author:null,width:null,height:null,url:null,download_url:null,requestId:e.meta.requestId,status:"loading"};t.list.push(n)})).addCase($.fulfilled,(function(t,e){var n=e.meta.requestId;t.onFill&&(t.onFillLoadingStatus="idle"),X(t.list,n)?t.list=Y(t.list,n,e.payload):X(t.deleted,n)&&(t.deleted=Y(t.deleted,n,e.payload)),t.onFill&&"loading"===t.onFillLoadingStatus&&(t.onFillLoadingStatus="idle")})).addCase($.rejected,(function(){}))}}),et=tt.reducer,nt=tt.actions,ot=(nt.changePhotoByRequestId,nt.deletePhoto),rt=nt.restorePhoto,at=nt.restoreAll,it=nt.setOnFill,ct=nt.clear,st=function(t){return t.photos.list},ut=function(t){return t.photos.deleted},lt=function(t){return t.photos.onFill},dt=function(t){return t.photos.onFillLoadingStatus},bt=(n(54),function(){var t=s(),e=u(lt),n=u(dt),r=u(st),a=u(J),i=u(z),c=Object(o.useState)(0),l=Object(F.a)(c,2),d=l[0],b=l[1],f=window.innerWidth<1280?window.innerWidth:1280,j=Math.floor((f-40+20)/(a+20)),h=window.innerHeight-66-40-49.8,p=Math.floor((h+20)/(i+20));Object(o.useEffect)((function(){e&&"idle"===n&&r.length<d&&t($())})),Object(o.useEffect)((function(){return b(j*(p+1)),document.addEventListener("scroll",(function(){return O})),function(){return document.removeEventListener("scroll",(function(){return O}))}}),[]);var O=function(t){t.target.documentElement.scrollHeight-window.innerHeight-t.target.documentElement.scrollTop<100&&e&&b(d+j)};return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)("ul",{className:P()("Container"),children:r.map((function(e){return Object(L.jsx)("li",{children:Object(L.jsx)(G,{content:e,onCross:function(){t(ot(e.id))}})},e.requestId||e.id)}))})})}),ft=n(7),jt=n(12),ht=n(35),pt=n.n(ht),Ot=Object(ft.b)({photos:et,options:R,server:y}),mt={key:"root",storage:pt.a,whitelist:["photos","options"]},gt=Object(jt.g)(mt,Ot),xt=Object(f.a)({reducer:gt,middleware:function(t){return t({serializableCheck:{ignoredActions:[jt.a,jt.f,jt.b,jt.c,jt.d,jt.e,"server"]}})}}),yt=xt,vt=Object(jt.h)(xt),_t=(n(57),n(58),function(){var t=s(),e=u(W),n=u(lt),r=u(W),a=u(U),i=Object(o.useRef)(null),c=function(){return t($())},l=Object(o.useState)(!1),d=Object(F.a)(l,2),b=d[0],f=d[1],j=function(t){f(!t),function(t){t?i.current=setInterval(c,3e3):clearInterval(i.current)}(!t)};return Object(L.jsxs)("header",{className:"Header",children:[Object(L.jsx)("button",{type:"button",onClick:function(){return t($())},className:P()("Header__button","button"),children:"Add"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(ot())},className:P()("Header__button","button"),children:"Delete"}),Object(L.jsx)("button",{type:"button",onClick:function(){t(it(!n))},className:P()("Header__button","button",{"button--active":n}),children:"FillByThunk"}),Object(L.jsx)("button",{type:"button",onClick:function(){return j(b)},className:P()("Header__button","button",{"button--active":b}),children:"FillBySetTimeInterval"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(ct())},className:P()("Header__button","button"),children:"Clear"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(M(!e)),void t(T(!1))},className:P()("Header__button","button",{"button--active":r}),children:"Options"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(T(!a)),void t(M(!1))},className:P()("Header__button","button"),children:"Show Deleted"}),Object(L.jsx)("button",{type:"button",onClick:function(){return vt.purge(),void window.location.reload()},className:P()("Header__button","button"),children:"Purge"})]})}),Nt=(n(59),n(60),n(61),["#48ff05","#6aff00","#98ff00","#b9ff01","#dcf600","#daf601","#e5c808","#f09900","#f52f02","#bf3217"]),Ct=function(t){var e=t.title,n=t.min,r=t.max,a=t.currentSelector,i=t.setCurrent,c=s(),l=u(a),d=Object(o.useCallback)((function(t){return n+(r-n)*t/10}),[]),b=function(t,e){return{width:25,backgroundColor:t,opacity:d(e)<l?1:.5}};return Object(L.jsxs)("div",{className:"Scale",children:[Object(L.jsx)("div",{className:"Scale__title",children:e}),Object(L.jsx)("div",{className:"Scale__base",children:Nt.map((function(t,e){return Object(L.jsx)("button",{type:"button",className:"Scale__button",onClick:function(){return function(t){c(i(n+(r-n)*t/10))}(e+1)},style:b(t,e)},t)}))}),Object(L.jsx)("div",{className:"Scale__current-value",children:l})]})},kt=function(){var t=s(),e=u(W),n=u(w);return Object(L.jsx)(L.Fragment,{children:e&&Object(L.jsx)("div",{className:"Options",children:Object(L.jsxs)("div",{children:[Object(L.jsx)(Ct,{title:"width",min:150,max:350,currentSelector:J,setCurrent:V}),Object(L.jsx)(Ct,{title:"height",min:150,max:250,currentSelector:z,setCurrent:B}),Object(L.jsx)(Ct,{title:"border-radius",min:0,max:20,currentSelector:K,setCurrent:A}),Object(L.jsxs)("div",{className:"Options__field",children:["random delay\xa0",Object(L.jsx)("div",{role:"checkbox","aria-checked":"false","aria-labelledby":"delay",tabIndex:0,className:P()("custom-checkbox",{"custom-checkbox--checked":n}),onClick:function(){return t(C(!n))},onKeyDown:function(){}})]})]})})})},wt=(n(62),function(t){var e=t.closeModal,n=t.content,r=s(),a=Object(o.useState)(!1),i=Object(F.a)(a,2),c=i[0],u=i[1];return Object(L.jsxs)("div",{className:"Modal",children:[Object(L.jsxs)("div",{className:"Modal__header",children:[Object(L.jsx)("h2",{children:"Deleted"}),Object(L.jsxs)("div",{className:"Modal__container",children:[Object(L.jsx)("button",{type:"button",onClick:function(){return e(!1)},className:P()("Modal__button","button"),children:"Close"}),Object(L.jsx)("button",{type:"button",onClick:function(){n.length?r(at()):(u(!0),setTimeout((function(){return u(!1)}),3e3))},className:P()("Modal__button","button"),children:"Restore All"})]})]}),c&&Object(L.jsx)("h2",{className:"Modal__title-empty",children:"Deleted is empty"}),Object(L.jsx)("ul",{className:"Modal__list",children:n.map((function(t){return Object(L.jsx)("li",{children:Object(L.jsx)(G,{content:t,onCross:function(){return(e=t.id)?r(rt(e)):null;var e}})},t.id||t.requestId)}))})]})}),It=(n(63),function(){var t=s(),e=u(k),n=u(ut),o=u(U);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_t,{}),Object(L.jsx)(kt,{}),Object(L.jsxs)("main",{className:"HomePage__main",children:["loading"===e&&Object(L.jsx)(S,{}),"failed"===e&&Object(L.jsx)(L.Fragment,{children:"Error"}),"idle"===e&&Object(L.jsx)(bt,{})]}),o&&Object(L.jsx)(wt,{closeModal:function(){return t(T(!1))},content:n})]})}),Lt=(n(64),function(){var t=s();return Object(o.useEffect)((function(){t(I)}),[]),Object(L.jsx)(It,{})});n(65);a.a.createRoot(document.getElementById("root")).render(Object(L.jsx)(c.a,{store:yt,children:Object(L.jsx)(i.a,{loading:null,persistor:vt,children:Object(L.jsx)(Lt,{})})}))}},[[66,1,2]]]);
//# sourceMappingURL=main.06d33300.chunk.js.map