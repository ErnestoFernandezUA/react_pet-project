(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{52:function(t,e,n){},54:function(t,e,n){},55:function(t,e,n){},58:function(t,e,n){},59:function(t,e,n){},60:function(t,e,n){},61:function(t,e,n){},62:function(t,e,n){},63:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){"use strict";n.r(e);var o=n(2),a=n.n(o),i=n(30),r=n.n(i),c=n(31),s=n(18),u=n(6),l=s.b,d=s.c,b=n(11),h=n(7),j=n(12),f=n(10),p=n(68),O="https://picsum.photos",m=p.a.create({baseURL:O}),g=function(t){return Object(j.a)(Object(h.a)().mark((function e(){var n;return Object(h.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m.get(t);case 2:return n=e.sent,console.log("fetch to",O+t),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))()},x=function(t,e){return g("v2/list?page=".concat(t,"&limit=").concat(e))},v=Object(f.b)("server/fetchPhotos",function(){var t=Object(j.a)(Object(h.a)().mark((function t(e){var n,o,a,i;return Object(h.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.page,o=e.limit,a=void 0===o?100:o,t.next=3,x(n,a);case 3:return i=t.sent,t.abrupt("return",i);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),y=Object(f.c)({name:"server",initialState:{storage:[],statusLoading:"idle",error:null,nextLoadingPhotoIndex:0,randomDelayLoading:!1},reducers:{add:function(t,e){var n;(n=t.storage).push.apply(n,Object(b.a)(e.payload))},sortById:function(t){t.storage.sort((function(t,e){return Number(t.id)-Number(e.id)}))},setStatusLoading:function(t,e){t.statusLoading=e.payload},setError:function(t,e){t.error=e.payload,t.statusLoading="failed"},loadNextPhoto:function(t){t.nextLoadingPhotoIndex+=1},setRandomDelay:function(t,e){t.randomDelayLoading=e.payload}},extraReducers:function(t){t.addCase(v.pending,(function(t){t.statusLoading="loading"})).addCase(v.fulfilled,(function(t,e){var n;e.payload.sort((function(t,e){return Number(t.id)-Number(e.id)})),(n=t.storage).push.apply(n,Object(b.a)(e.payload)),t.statusLoading="idle"})).addCase(v.rejected,(function(t){t.statusLoading="failed"}))}}),_=y.reducer,N=y.actions,w=(N.add,N.sortById,N.setStatusLoading,N.setError),C=N.loadNextPhoto,k=N.setRandomDelay,L=function(t){return t.server.storage},I=function(t){return t.server.statusLoading},F=function(t){return t.server.randomDelayLoading},S=function(t){try{t(v({page:1,limit:100}))}catch(e){t(w(e))}},D=(n(52),n(1)),P=function(){return Object(D.jsx)("div",{className:"Loader",children:Object(D.jsx)("div",{className:"Loader__content"})})},H=n(5),q=n.n(H),R={isVisible:!1,showDeleted:!1,width:350,height:250,"border-radius":5},M=Object(f.c)({name:"options",initialState:R,reducers:{setVisible:function(t,e){t.isVisible=e.payload},setWidth:function(t,e){e.payload>0&&e.payload<=350&&(t.width=e.payload)},setHeight:function(t,e){e.payload>0&&e.payload<=350&&(t.height=e.payload)},setBorderRadius:function(t,e){e.payload>=0&&e.payload<=50&&(t["border-radius"]=e.payload)},resetOptions:function(t){R},someFunction:function(t){t.showDeleted=!t.showDeleted}}}),E=M.reducer,B=M.actions,A=B.setVisible,T=B.setWidth,V=B.setHeight,W=B.setBorderRadius,z=(B.resetOptions,B.someFunction),J=function(t){return t.options.isVisible},K=function(t){return t.options.height},U=function(t){return t.options.width},G=function(t){return t.options["border-radius"]},Q=function(t){return t.options.showDeleted},X=(n(54),function(t){var e=t.content,n=e.author,o=e.download_url,a=e.status,i={width:d(U),minWidth:"200px",height:d(K),borderRadius:d(G),backgroundImage:"url(".concat(o,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"};return Object(D.jsxs)("div",{className:q()("Card",{CardLoader:"loading"===a}),style:i,children:["loading"===a&&Object(D.jsx)("div",{className:"CardLoader__content"}),"idle"===a&&Object(D.jsx)("div",{className:"Card--visible",children:Object(D.jsx)("div",{className:"Card__title",children:n})})]})}),Y=n(9);function Z(t,e){return t.findIndex((function(t){return t.requestId===e}))>=0}function $(t,e,n){return t.map((function(t){return t.requestId!==e?t:Object(Y.a)(Object(Y.a)(Object(Y.a)({},t),n),{},{status:"idle",requestId:null})}))}var tt=Object(f.b)("photo/fetchPhoto",function(){var t=Object(j.a)(Object(h.a)().mark((function t(e,n){var o,a,i,r,c;return Object(h.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.getState(),a=o.server,i=a.storage[a.nextLoadingPhotoIndex],n.dispatch(C()),r=300,o.server.randomDelayLoading&&(r=1e3+3e3*Math.random()),t.next=8,new Promise((function(t){setTimeout((function(){return t(Object(Y.a)(Object(Y.a)({},i),{},{requestId:n.requestId,status:"loading"}))}),r)}));case 8:return c=t.sent,t.abrupt("return",c);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),et=Object(f.c)({name:"photo",initialState:{list:[],deleted:[],onFill:!1,onFillLoadingStatus:"idle"},reducers:{changePhotoByRequestId:function(t,e){t.list.forEach((function(t){return t.requestId!==e.payload.requestId?t:Object(Y.a)(Object(Y.a)(Object(Y.a)({},t),e.payload.photo),{},{status:e.payload.status})}))},deletePhoto:function(t,e){if(e.payload){var n,o=t.list.findIndex((function(t){return t.id===e.payload}));if(o)(n=t.deleted).push.apply(n,Object(b.a)(t.list.splice(o,1)))}else t.list.length&&(t.deleted.push(t.list[t.list.length-1]),t.list.length-=1)},restorePhoto:function(t,e){if(e.payload){var n,o=t.deleted.findIndex((function(t){return t.id===e.payload}));if(o)(n=t.list).push.apply(n,Object(b.a)(t.deleted.splice(o,1)))}},restoreAll:function(t){var e;(e=t.list).push.apply(e,Object(b.a)(t.deleted)),t.deleted.length=0},setOnFill:function(t,e){t.onFill=e.payload},clear:function(t){var e;(e=t.deleted).push.apply(e,Object(b.a)(t.list.splice(1)))}},extraReducers:function(t){t.addCase(tt.pending,(function(t,e){t.onFill&&(t.onFillLoadingStatus="loading");var n={id:null,author:null,width:null,height:null,url:null,download_url:null,requestId:e.meta.requestId,status:"loading"};t.list.push(n)})).addCase(tt.fulfilled,(function(t,e){var n=e.meta.requestId;t.onFill&&(t.onFillLoadingStatus="idle"),Z(t.list,n)?t.list=$(t.list,n,e.payload):Z(t.deleted,n)&&(t.deleted=$(t.deleted,n,e.payload)),t.onFill&&"loading"===t.onFillLoadingStatus&&(t.onFillLoadingStatus="idle")})).addCase(tt.rejected,(function(){}))}}),nt=et.reducer,ot=et.actions,at=(ot.changePhotoByRequestId,ot.deletePhoto),it=ot.restorePhoto,rt=ot.restoreAll,ct=ot.setOnFill,st=ot.clear,ut=function(t){return t.photos.list},lt=function(t){return t.photos.deleted},dt=function(t){return t.photos.onFill},bt=function(t){return t.photos.onFillLoadingStatus},ht=(n(55),function(){var t=l(),e=d(dt),n=d(bt),a=d(ut),i=d(U),r=d(K),c=Object(o.useState)(0),s=Object(u.a)(c,2),b=s[0],h=s[1],j=window.innerWidth<1280?window.innerWidth:1280,f=Math.floor((j-40+20)/(i+20)),p=window.innerHeight-66-40-49.8,O=Math.floor((p+20)/(r+20));Object(o.useEffect)((function(){e&&"idle"===n&&a.length<b&&t(tt())})),Object(o.useEffect)((function(){return h(f*(O+1)),document.addEventListener("scroll",(function(){return m})),function(){return document.removeEventListener("scroll",(function(){return m}))}}),[]);var m=function(t){t.target.documentElement.scrollHeight-window.innerHeight-t.target.documentElement.scrollTop<100&&e&&h(b+f)};return Object(D.jsx)(D.Fragment,{children:Object(D.jsx)("ul",{className:q()("Container"),children:a.map((function(e){return Object(D.jsx)("li",{children:Object(D.jsx)(X,{content:e,onCross:function(){return t(at(e.id))}})},e.requestId||e.id)}))})})}),jt=n(8),ft=n(13),pt=n(36),Ot=n.n(pt),mt=Object(jt.b)({photos:nt,options:E,server:_}),gt={key:"root",storage:Ot.a,whitelist:["photos","options"]},xt=Object(ft.g)(gt,mt),vt=Object(f.a)({reducer:xt,middleware:function(t){return t({serializableCheck:{ignoredActions:[ft.a,ft.f,ft.b,ft.c,ft.d,ft.e,"server"]}})}}),yt=vt,_t=Object(ft.h)(vt),Nt=(n(58),n(59),function(){var t=l(),e=d(J),n=d(dt),a=d(J),i=Object(o.useRef)(null);console.log(d(L));var r=function(){return t(tt())},c=Object(o.useState)(!1),s=Object(u.a)(c,2),b=s[0],h=s[1],j=function(t){h(!t),function(t){t?i.current=setInterval(r,3e3):clearInterval(i.current)}(!t)};return Object(D.jsxs)("header",{className:"Header",children:[Object(D.jsx)("button",{type:"button",onClick:function(){return t(tt())},className:q()("Header__button","button"),children:"Add"}),Object(D.jsx)("button",{type:"button",onClick:function(){return t(at())},className:q()("Header__button","button"),children:"Delete"}),Object(D.jsx)("button",{type:"button",onClick:function(){t(ct(!n))},className:q()("Header__button","button",{"button--active":n}),children:"FillByThunk"}),Object(D.jsx)("button",{type:"button",onClick:function(){return j(b)},className:q()("Header__button","button",{"button--active":b}),children:"FillBySetTimeInterval"}),Object(D.jsx)("button",{type:"button",onClick:function(){return t(st())},className:q()("Header__button","button"),children:"Clear"}),Object(D.jsx)("button",{type:"button",onClick:function(){return t(A(!e))},className:q()("Header__button","button",{"button--active":a}),children:"Options"}),Object(D.jsx)("button",{type:"button",onClick:function(){return t(z())},className:q()("Header__button","button"),children:"Show Deleted"}),Object(D.jsx)("button",{type:"button",onClick:function(){return _t.purge(),void window.location.reload()},className:q()("Header__button","button"),children:"Purge"})]})}),wt=n(23),Ct=(n(60),n(61),function(){var t=l(),e=d(J),n=d(U),a=d(K),i=d(G),r=d(F),c=Object(o.useState)({width:n,height:a,"border-radius":i}),s=Object(u.a)(c,2),b=s[0],h=b.width,j=b.height,f=b["border-radius"],p=s[1],O=function(t){var e=t.target,n=e.name,o=e.value;p((function(t){return Object(Y.a)(Object(Y.a)({},t),{},Object(wt.a)({},n,+o))}))};return e?Object(D.jsx)("form",{onSubmit:function(e){return e.preventDefault(),t(T(h)),t(V(j)),t(W(f)),void t(A(!1))},className:"Options",children:Object(D.jsxs)("div",{children:[Object(D.jsx)("div",{className:"Options__field",children:Object(D.jsxs)("label",{htmlFor:"width",children:["width\xa0",Object(D.jsx)("input",{type:"text",name:"width",id:"width",onChange:O,className:"Options__input",value:h}),"\xa0px"]})}),Object(D.jsx)("div",{className:"Options__field",children:Object(D.jsxs)("label",{htmlFor:"height",children:["height\xa0",Object(D.jsx)("input",{type:"text",name:"height",id:"height",onChange:O,className:"Options__input",value:j}),"\xa0px"]})}),Object(D.jsx)("div",{className:"Options__field",children:Object(D.jsxs)("label",{htmlFor:"height",children:["border-radius\xa0",Object(D.jsx)("input",{type:"text",name:"border-radius",id:"height",onChange:O,className:"Options__input",value:f}),"\xa0px"]})}),Object(D.jsxs)("div",{className:"Options__field",children:["random delay\xa0",Object(D.jsx)("div",{role:"checkbox","aria-checked":"false","aria-labelledby":"delay",tabIndex:0,className:q()("custom-checkbox",{"custom-checkbox--checked":r}),onClick:function(){return t(k(!r))},onKeyDown:function(){}})]}),Object(D.jsx)("div",{className:"Options__field",children:Object(D.jsx)("button",{type:"submit",className:"Options__bottom",children:"Submit"})})]})}):null}),kt=(n(62),function(t){var e=t.closeModal,n=t.content,a=l(),i=Object(o.useState)(!1),r=Object(u.a)(i,2),c=r[0],s=r[1];return Object(D.jsxs)("div",{className:"Modal",children:[Object(D.jsxs)("div",{className:"Modal__header",children:[Object(D.jsx)("h2",{children:"Deleted"}),Object(D.jsxs)("div",{className:"Modal__container",children:[Object(D.jsx)("button",{type:"button",onClick:function(){return e(!1)},className:q()("Modal__button","button"),children:"Close"}),Object(D.jsx)("button",{type:"button",onClick:function(){n.length?a(rt()):(s(!0),setTimeout((function(){return s(!1)}),3e3))},className:q()("Modal__button","button"),children:"Restore All"})]})]}),c&&Object(D.jsx)("h2",{className:"Modal__title-empty",children:"Deleted is empty"}),Object(D.jsx)("ul",{className:"Modal__list",children:n.map((function(t){return Object(D.jsx)("li",{children:Object(D.jsx)(X,{content:t,onCross:function(){return(e=t.id)?a(it(e)):null;var e}})},t.id||t.requestId)}))})]})}),Lt=(n(63),function(){var t=l(),e=d(I),n=d(lt),o=d(Q);return Object(D.jsxs)(D.Fragment,{children:[Object(D.jsx)(Nt,{}),Object(D.jsxs)("main",{className:"HomePage__main",children:["loading"===e&&Object(D.jsx)(P,{}),"failed"===e&&Object(D.jsx)(D.Fragment,{children:"Error"}),"idle"===e&&Object(D.jsx)(ht,{})]}),o&&Object(D.jsx)(kt,{closeModal:function(){return t(z())},content:n}),Object(D.jsx)(Ct,{})]})}),It=(n(64),function(){var t=l(),e=d(L),n=Object(o.useState)(!0),a=Object(u.a)(n,2),i=a[0],r=a[1];return Object(o.useEffect)((function(){t(S)}),[]),e.length>0&&i&&r(!1),Object(D.jsx)(Lt,{})});n(65);r.a.createRoot(document.getElementById("root")).render(Object(D.jsx)(a.a.StrictMode,{children:Object(D.jsx)(s.a,{store:yt,children:Object(D.jsx)(c.a,{loading:null,persistor:_t,children:Object(D.jsx)(It,{})})})}))}},[[66,1,2]]]);
//# sourceMappingURL=main.b0352770.chunk.js.map