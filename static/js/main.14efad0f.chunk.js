(this["webpackJsonpreact-typescript-starter-pack"]=this["webpackJsonpreact-typescript-starter-pack"]||[]).push([[0],{52:function(t,e,n){},54:function(t,e,n){},55:function(t,e,n){},58:function(t,e,n){},59:function(t,e,n){},60:function(t,e,n){},61:function(t,e,n){},62:function(t,e,n){},63:function(t,e,n){},64:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){"use strict";n.r(e);var o=n(2),i=n(30),a=n.n(i),r=n(31),c=n(18),s=c.b,l=c.c,u=n(11),d=n(6),b=n(12),h=n(10),j=n(68),p="https://picsum.photos",f=j.a.create({baseURL:p}),O=function(t){return Object(b.a)(Object(d.a)().mark((function e(){var n;return Object(d.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f.get(t);case 2:return n=e.sent,console.log("fetch to",p+t),e.abrupt("return",n.data);case 5:case"end":return e.stop()}}),e)})))()},m=function(t,e){return O("v2/list?page=".concat(t,"&limit=").concat(e))},g=Object(h.b)("server/fetchPhotos",function(){var t=Object(b.a)(Object(d.a)().mark((function t(e){var n,o,i,a;return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.page,o=e.limit,i=void 0===o?100:o,t.next=3,m(n,i);case 3:return a=t.sent,t.abrupt("return",a);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),x=Object(h.c)({name:"server",initialState:{storage:[],statusLoading:"idle",error:null,nextLoadingPhotoIndex:0,randomDelayLoading:!1},reducers:{add:function(t,e){var n;(n=t.storage).push.apply(n,Object(u.a)(e.payload))},sortById:function(t){t.storage.sort((function(t,e){return Number(t.id)-Number(e.id)}))},setStatusLoading:function(t,e){t.statusLoading=e.payload},setError:function(t,e){t.error=e.payload,t.statusLoading="failed"},loadNextPhoto:function(t){t.nextLoadingPhotoIndex+=1},setRandomDelay:function(t,e){t.randomDelayLoading=e.payload}},extraReducers:function(t){t.addCase(g.pending,(function(t){t.statusLoading="loading"})).addCase(g.fulfilled,(function(t,e){var n;e.payload.sort((function(t,e){return Number(t.id)-Number(e.id)})),(n=t.storage).push.apply(n,Object(u.a)(e.payload)),t.statusLoading="idle"})).addCase(g.rejected,(function(t){t.statusLoading="failed"}))}}),v=x.reducer,y=x.actions,_=(y.add,y.sortById,y.setStatusLoading,y.setError),N=y.loadNextPhoto,w=y.setRandomDelay,C=function(t){return t.server.statusLoading},k=function(t){return t.server.randomDelayLoading},I=function(t){try{t(g({page:1,limit:100}))}catch(e){t(_(e))}},L=(n(52),n(1)),F=function(){return Object(L.jsx)("div",{className:"Loader",children:Object(L.jsx)("div",{className:"Loader__content"})})},S=n(8),D=n(5),P=n.n(D),H={isOptionsVisible:!1,isDeletedVisible:!1,width:350,height:250,"border-radius":5},q=Object(h.c)({name:"options",initialState:H,reducers:{setVisible:function(t,e){t.isOptionsVisible=e.payload},setWidth:function(t,e){e.payload>0&&e.payload<=350&&(t.width=e.payload)},setHeight:function(t,e){e.payload>0&&e.payload<=350&&(t.height=e.payload)},setBorderRadius:function(t,e){e.payload>=0&&e.payload<=50&&(t["border-radius"]=e.payload)},resetOptions:function(t){H},changeVisibleDeleted:function(t,e){t.isDeletedVisible=e.payload}}}),R=q.reducer,E=q.actions,M=E.setVisible,V=E.setWidth,B=E.setHeight,A=E.setBorderRadius,T=(E.resetOptions,E.changeVisibleDeleted),W=function(t){return t.options.isOptionsVisible},z=function(t){return t.options.height},J=function(t){return t.options.width},K=function(t){return t.options["border-radius"]},U=function(t){return t.options.isDeletedVisible},G=(n(54),function(t){var e=t.content,n=t.onCross,o=e.author,i=e.download_url,a=e.status,r={width:l(J),minWidth:"200px",height:l(z),borderRadius:l(K),backgroundImage:"url(".concat(i,")"),backgroundSize:"cover",backgroundRepeat:"no-repeat"};return Object(L.jsxs)("div",{className:P()("Card",{CardLoader:"loading"===a}),style:r,children:["loading"===a&&Object(L.jsx)("div",{className:"CardLoader__content"}),"idle"===a&&Object(L.jsxs)("div",{className:"Card--visible",children:[Object(L.jsx)("div",{className:"Card__title",children:o}),Object(L.jsx)("div",{className:"Card__button-cross",onClick:function(){return n()},onKeyDown:function(){n()},role:"button",tabIndex:0})]})]})}),Q=n(9);function X(t,e){return t.findIndex((function(t){return t.requestId===e}))>=0}function Y(t,e,n){return t.map((function(t){return t.requestId!==e?t:Object(Q.a)(Object(Q.a)(Object(Q.a)({},t),n),{},{status:"idle",requestId:null})}))}var Z={list:[],deleted:[],onFill:!1,onFillLoadingStatus:"idle"},$=Object(h.b)("photo/fetchPhoto",function(){var t=Object(b.a)(Object(d.a)().mark((function t(e,n){var o,i,a,r,c;return Object(d.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=n.getState(),i=o.server,a=i.storage[i.nextLoadingPhotoIndex],n.dispatch(N()),r=300,o.server.randomDelayLoading&&(r=1e3+3e3*Math.random()),t.next=8,new Promise((function(t){setTimeout((function(){return t(Object(Q.a)(Object(Q.a)({},a),{},{requestId:n.requestId,status:"loading"}))}),r)}));case 8:return c=t.sent,t.abrupt("return",c);case 10:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()),tt=Object(h.c)({name:"photo",initialState:Z,reducers:{changePhotoByRequestId:function(t,e){t.list.forEach((function(t){return t.requestId!==e.payload.requestId?t:Object(Q.a)(Object(Q.a)(Object(Q.a)({},t),e.payload.photo),{},{status:e.payload.status})}))},deletePhoto:function(t,e){if(e.payload||"0"===e.payload){var n,o=t.list.findIndex((function(t){return t.id===e.payload}));if(o>=0)(n=t.deleted).push.apply(n,Object(u.a)(t.list.splice(o,1)))}else t.list.length&&(t.deleted.push(t.list[t.list.length-1]),t.list.length--)},restorePhoto:function(t,e){if(e.payload||"0"===e.payload){var n,o=t.deleted.findIndex((function(t){return t.id===e.payload}));if(console.log(o),o>=0)(n=t.list).push.apply(n,Object(u.a)(t.deleted.splice(o,1)))}},restoreAll:function(t){var e;(e=t.list).push.apply(e,Object(u.a)(t.deleted)),t.deleted.length=0},setOnFill:function(t,e){t.onFill=e.payload},clear:function(t){var e;(e=t.deleted).push.apply(e,Object(u.a)(t.list.splice(1)))},reset:function(){return Z}},extraReducers:function(t){t.addCase($.pending,(function(t,e){t.onFill&&(t.onFillLoadingStatus="loading");var n={id:null,author:null,width:null,height:null,url:null,download_url:null,requestId:e.meta.requestId,status:"loading"};t.list.push(n)})).addCase($.fulfilled,(function(t,e){var n=e.meta.requestId;t.onFill&&(t.onFillLoadingStatus="idle"),X(t.list,n)?t.list=Y(t.list,n,e.payload):X(t.deleted,n)&&(t.deleted=Y(t.deleted,n,e.payload)),t.onFill&&"loading"===t.onFillLoadingStatus&&(t.onFillLoadingStatus="idle")})).addCase($.rejected,(function(){}))}}),et=tt.reducer,nt=tt.actions,ot=(nt.changePhotoByRequestId,nt.deletePhoto),it=nt.restorePhoto,at=nt.restoreAll,rt=nt.setOnFill,ct=nt.clear,st=function(t){return t.photos.list},lt=function(t){return t.photos.deleted},ut=function(t){return t.photos.onFill},dt=function(t){return t.photos.onFillLoadingStatus},bt=(n(55),function(){var t=s(),e=l(ut),n=l(dt),i=l(st),a=l(J),r=l(z),c=Object(o.useState)(0),u=Object(S.a)(c,2),d=u[0],b=u[1],h=window.innerWidth<1280?window.innerWidth:1280,j=Math.floor((h-40+20)/(a+20)),p=window.innerHeight-66-40-49.8,f=Math.floor((p+20)/(r+20));Object(o.useEffect)((function(){e&&"idle"===n&&i.length<d&&t($())})),Object(o.useEffect)((function(){return b(j*(f+1)),document.addEventListener("scroll",(function(){return O})),function(){return document.removeEventListener("scroll",(function(){return O}))}}),[]);var O=function(t){t.target.documentElement.scrollHeight-window.innerHeight-t.target.documentElement.scrollTop<100&&e&&b(d+j)};return Object(L.jsx)(L.Fragment,{children:Object(L.jsx)("ul",{className:P()("Container"),children:i.map((function(e){return Object(L.jsx)("li",{children:Object(L.jsx)(G,{content:e,onCross:function(){t(ot(e.id))}})},e.requestId||e.id)}))})})}),ht=n(7),jt=n(13),pt=n(36),ft=n.n(pt),Ot=Object(ht.b)({photos:et,options:R,server:v}),mt={key:"root",storage:ft.a,whitelist:["photos","options"]},gt=Object(jt.g)(mt,Ot),xt=Object(h.a)({reducer:gt,middleware:function(t){return t({serializableCheck:{ignoredActions:[jt.a,jt.f,jt.b,jt.c,jt.d,jt.e,"server"]}})}}),vt=xt,yt=Object(jt.h)(xt),_t=(n(58),n(59),function(){var t=s(),e=l(W),n=l(ut),i=l(W),a=l(U),r=Object(o.useRef)(null),c=function(){return t($())},u=Object(o.useState)(!1),d=Object(S.a)(u,2),b=d[0],h=d[1],j=function(t){h(!t),function(t){t?r.current=setInterval(c,3e3):clearInterval(r.current)}(!t)};return Object(L.jsxs)("header",{className:"Header",children:[Object(L.jsx)("button",{type:"button",onClick:function(){return t($())},className:P()("Header__button","button"),children:"Add"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(ot())},className:P()("Header__button","button"),children:"Delete"}),Object(L.jsx)("button",{type:"button",onClick:function(){t(rt(!n))},className:P()("Header__button","button",{"button--active":n}),children:"FillByThunk"}),Object(L.jsx)("button",{type:"button",onClick:function(){return j(b)},className:P()("Header__button","button",{"button--active":b}),children:"FillBySetTimeInterval"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(ct())},className:P()("Header__button","button"),children:"Clear"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(M(!e)),void t(T(!1))},className:P()("Header__button","button",{"button--active":i}),children:"Options"}),Object(L.jsx)("button",{type:"button",onClick:function(){return t(T(!a)),void t(M(!1))},className:P()("Header__button","button"),children:"Show Deleted"}),Object(L.jsx)("button",{type:"button",onClick:function(){return yt.purge(),void window.location.reload()},className:P()("Header__button","button"),children:"Purge"})]})}),Nt=n(23),wt=(n(60),n(61),function(){var t=s(),e=l(W),n=l(J),i=l(z),a=l(K),r=l(k),c=Object(o.useState)({width:n,height:i,"border-radius":a}),u=Object(S.a)(c,2),d=u[0],b=d.width,h=d.height,j=d["border-radius"],p=u[1],f=function(t){var e=t.target,n=e.name,o=e.value;p((function(t){return Object(Q.a)(Object(Q.a)({},t),{},Object(Nt.a)({},n,+o))}))};return Object(L.jsx)(L.Fragment,{children:e&&Object(L.jsx)("form",{onSubmit:function(e){return e.preventDefault(),t(V(b)),t(B(h)),t(A(j)),void t(M(!1))},className:P()("Options",{"Options--visible":e}),children:Object(L.jsxs)("div",{children:[Object(L.jsx)("div",{className:"Options__field",children:Object(L.jsxs)("label",{htmlFor:"width",children:["width\xa0",Object(L.jsx)("input",{type:"text",name:"width",id:"width",onChange:f,className:"Options__input",value:b}),"\xa0px"]})}),Object(L.jsx)("div",{className:"Options__field",children:Object(L.jsxs)("label",{htmlFor:"height",children:["height\xa0",Object(L.jsx)("input",{type:"text",name:"height",id:"height",onChange:f,className:"Options__input",value:h}),"\xa0px"]})}),Object(L.jsx)("div",{className:"Options__field",children:Object(L.jsxs)("label",{htmlFor:"height",children:["border-radius\xa0",Object(L.jsx)("input",{type:"text",name:"border-radius",id:"height",onChange:f,className:"Options__input",value:j}),"\xa0px"]})}),Object(L.jsxs)("div",{className:"Options__field",children:["random delay\xa0",Object(L.jsx)("div",{role:"checkbox","aria-checked":"false","aria-labelledby":"delay",tabIndex:0,className:P()("custom-checkbox",{"custom-checkbox--checked":r}),onClick:function(){return t(w(!r))},onKeyDown:function(){}})]}),Object(L.jsx)("div",{className:"Options__field",children:Object(L.jsx)("button",{type:"submit",className:"Options__bottom",children:"Submit"})})]})})})}),Ct=(n(62),function(t){var e=t.closeModal,n=t.content,i=s(),a=Object(o.useState)(!1),r=Object(S.a)(a,2),c=r[0],l=r[1];return Object(L.jsxs)("div",{className:"Modal",children:[Object(L.jsxs)("div",{className:"Modal__header",children:[Object(L.jsx)("h2",{children:"Deleted"}),Object(L.jsxs)("div",{className:"Modal__container",children:[Object(L.jsx)("button",{type:"button",onClick:function(){return e(!1)},className:P()("Modal__button","button"),children:"Close"}),Object(L.jsx)("button",{type:"button",onClick:function(){n.length?i(at()):(l(!0),setTimeout((function(){return l(!1)}),3e3))},className:P()("Modal__button","button"),children:"Restore All"})]})]}),c&&Object(L.jsx)("h2",{className:"Modal__title-empty",children:"Deleted is empty"}),Object(L.jsx)("ul",{className:"Modal__list",children:n.map((function(t){return Object(L.jsx)("li",{children:Object(L.jsx)(G,{content:t,onCross:function(){return(e=t.id)?i(it(e)):null;var e}})},t.id||t.requestId)}))})]})}),kt=(n(63),function(){var t=s(),e=l(C),n=l(lt),o=l(U);return Object(L.jsxs)(L.Fragment,{children:[Object(L.jsx)(_t,{}),Object(L.jsx)(wt,{}),Object(L.jsxs)("main",{className:"HomePage__main",children:["loading"===e&&Object(L.jsx)(F,{}),"failed"===e&&Object(L.jsx)(L.Fragment,{children:"Error"}),"idle"===e&&Object(L.jsx)(bt,{})]}),o&&Object(L.jsx)(Ct,{closeModal:function(){return t(T(!1))},content:n})]})}),It=(n(64),function(){var t=s();return Object(o.useEffect)((function(){t(I)}),[]),Object(L.jsx)(kt,{})});n(65);a.a.createRoot(document.getElementById("root")).render(Object(L.jsx)(c.a,{store:vt,children:Object(L.jsx)(r.a,{loading:null,persistor:yt,children:Object(L.jsx)(It,{})})}))}},[[66,1,2]]]);
//# sourceMappingURL=main.14efad0f.chunk.js.map